#!/usr/bin/perl -w
#-------------------------------------------------------------------------------------------
# Fichero: $Id$
#-------------------------------------------------------------------------------------------
use lib "/opt/crawler/bin";
use lib "/opt/crawler/bin/support";
use strict;
use Getopt::Std;
use System;
use MCNM;
use CNMOS;

# Informacion ------------------------------------------------------------------------------
my @fpth = split ('/',$0,10);
my @fname = split ('\.',$fpth[$#fpth],10);
my $USAGE = <<USAGE;
Valida la configuracion basica de la maquina.
(c) fml
$fpth[$#fpth] [-u xxx] 	: Hace los updates desde la version xxxx. Si no se pone valor xxx=0
$fpth[$#fpth] -h  		: Ayuda

USAGE

#-------------------------------------------------------------------------------------------
my %opts=();
my $REV=0;
getopts("u:h",\%opts);
if ($opts{h}) { die $USAGE; }
if ( (exists $opts{u}) && ($opts{u}=~/\d+/) ) { $REV=$opts{u}; }


#-------------------------------------------------------------------------------------------
pre_system_configuration();

#-------------------------------------------------------------------------------------------
os2system();

#-------------------------------------------------------------------------------------------
do_apt_install();

#-------------------------------------------------------------------------------------------
do_perl_module_check_all();

#-------------------------------------------------------------------------------------------
post_system_configuration();

#-------------------------------------------------------------------------------------------
do_updates();

#-------------------------------------------------------------------------------------------
store_key();

#-------------------------------------------------------------------------------------------
my $cnmos=CNMOS->new();
$cnmos->validate_dir();
$cnmos->validate_dir_files();

